# ==========================================================
# TERAUNIT-CORE: INDUSTRIAL CONFIGURATION
# ==========================================================

# 1. CORE ENGINE & VIRTUAL THREADS (JDK 21)
spring.application.name=teraunit-core
# Forces the entire Web Server and @Async tasks onto Virtual Threads
spring.threads.virtual.enabled=true

# 2. TASK SCHEDULING (FOR SCRAPERS)
# This replaces the need for AppConfig.java.
# It tells the @Scheduled tasks to use Virtual Threads by name.
spring.task.scheduling.thread-name-prefix=scheduling-vt-

# 3. REDIS (CACHE / OFFERS)
# Public repo hygiene: configure via environment variables.
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}

# Set true if your Redis endpoint requires TLS.
spring.data.redis.ssl.enabled=${REDIS_SSL:false}

spring.data.redis.timeout=5000ms

# 4. SWAGGER / STOREFRONT
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/api-docs

# 5. POSTGRES PERSISTENCE (PHASE 2 PREP)
spring.jpa.hibernate.ddl-auto=update
spring.datasource.url=${JDBC_DATABASE_URL:}
spring.datasource.username=${JDBC_DATABASE_USERNAME}
spring.datasource.password=${JDBC_DATABASE_PASSWORD}

# 6. OBSERVABILITY
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=always

# THE VAULT (Protocol 1 & 4)
# Set via environment variable; do NOT commit real keys to the repo.
TERA_VAULT_KEY=${TERA_VAULT_KEY}

# CONTROL PLANE AUTH (Launch endpoint)
# Set this in env as TERA_CONTROL_TOKEN (or TERAUNIT_CONTROL_TOKEN)
teraunit.control-token=${TERA_CONTROL_TOKEN}

# If running behind a reverse proxy, set true and ensure proxy is trusted.
teraunit.trust-forwarded-headers=${TERA_TRUST_FORWARDED_HEADERS}

# Heartbeats require a per-instance token by default.
teraunit.heartbeat.allow-unauthenticated=${TERA_HEARTBEAT_ALLOW_UNAUTH}

# Hard stop lease (minutes). Prevents weekend leaks even if heartbeats keep flowing.
# Set env `TERA_MAX_RUNTIME_MINUTES=0` to disable.
teraunit.instance.max-runtime-minutes=${TERA_MAX_RUNTIME_MINUTES}

# THE HEARTBEAT LINK (Protocol 6)
# Default to localhost for safety, but override this in Prod/Testing
teraunit.callback-url=${TERA_CALLBACK_URL}
